<!DOCTYPE html>
<html>
  <head>
    <title>RobotReviewer report</title>
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='scripts/spa/css/foundation.css') }}">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
     .judgement {
       margin: 0 0 0 1em;
     }
     .judgement li {
       font-size: x-small;
       color: #ccc;
       line-height: 1.125rem;
      }

     .judgement li:not(:last-child) {
       margin-bottom: 0.5rem;
     }
     .judgement li i {
       vertical-align: middle;
       font-size: 0.875rem;
       margin-left: 3px;
       margin-top: -5px;
     }
     .judgement li span {
       color: #222222;
       font-size: 0.875rem;
     }

     .judgement a[data-tooltip] {
       display: inline;
       position: relative;
     }

     .judgement a[data-tooltip]:hover:after {
       font-weight: 300;
       font-size: small;
       background: rgba(0,0,0,.8);
       border-radius: 2px;
       bottom: 22px;
       color: #fff;
       content: attr(data-tooltip);
       display: block;
       left: 0;
       padding: 5px 15px;
       position: absolute;
       white-space: nowrap;
       z-index: 98;
     }

     .judgement a[data-tooltip]:hover:before {
       border: solid;
       border-color: rgba(0,0,0,.8) transparent;
       border-width: 6px 6px 0 6px;
       bottom: 16px;
       content: "";
       display: block;
       left: 25%;
       position: absolute;
       z-index: 99;
     }

     .bias-table {
       width: 400px;
       margin-left:auto;
       margin-right:auto;
       border-collapse: collapse;
       /*color: white;*/
       border: none;
       padding: 0;

     }
     .bias-table td {
       padding: 0.5625rem 0.225rem;
     }

     .risk-low {
       background-color: #87BB2A;
       color: white;
       text-align: center;
     }

     .risk-high {
       background-color: #EA4747;
       color: white;
       text-align: center;
     }

     .trial-id-header {
       vertical-align: bottom;
       text-align: left;
     }

     th.rotate {
       /* Something you can count on */
       height: 300px;
       white-space: nowrap;
     }

     th.rotate > div {
       transform: translate(25px, 131px)
       rotate(315deg);
       width: 30px;
     }

     th.rotate > div > span {
       border-bottom: 1px solid #ccc;
       padding: 5px 10px;
     }

     .reportcontainer {
       width: 800px;
       margin-left:auto;
       margin-right:auto;

     }
    </style>
  </head>

  <body>
    <div class="reportcontainer">
      <h1>RobotReviewer report</h1>

      <h2>Risk of bias table</h2>

      <table class='bias-table'>
        <tr class='bias-header-row'>
          <th class='trial-id-header'>trial</th>
          {% for header in headers %}
          <th class="rotate"><div><span>{{ header }}</span></div></th>
          {% endfor %}
        </tr>


        {% for study in articles %}
        <tr>
          <td class ="risk-studyid"><a target="_parent" href="/#document/{{ report_uuid }}/{{ study['pdf_uuid'] }}?annotation_type=bias_bot" class="annotation-link">{{ study['short_citation'] }}</a></td>
          {% for domain in study['bias'] %}
          <td class="{% if domain['judgement'] == 'low' %}risk-low{% elif domain['judgement'] == 'high/unclear' %}risk-high{% endif %}">{{ '+' if domain['judgement'] == 'low' else '?' }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </table>


      <h2>Characteristics of studies</h2>
      {% for study in articles %}
      <h3>{{ study['short_citation'] }}</h3>

      <table>
        {% for domain in study['pico_text'] %}
        <tr>
          <td>{{ domain['domain'] }}</td>
          <td>
            <ol class="judgement">
            {% for ann in domain['annotations'] %}
              <li>
                <span>{{ ann['content'] }}</span>
                <a data-tooltip="jump to annotation" target="_parent" href="/#document/{{ report_uuid }}/{{ study['pdf_uuid'] }}?annotation_type=pico_bot&uuid={{ ann['uuid'] }}" class="annotation-link"><i class="fa fa-file-pdf-o" aria-hidden="true"></i></a>
              </li>
            {% endfor %}
            </ol>
          </td>
        </tr>
        {% endfor %}
      </table>

      <table>
        <tr>
          <th>Bias</th><th>Judgement</th>
          <th>Support for judgement</th>
        </tr>
        {% for domain in study['bias'] %}
        <tr>
          <td>{{ domain['domain'] }}</td>
          <td>{{ domain['judgement'] }}</td>
          <td>
            <ol class="judgement">
            {% for ann in domain['annotations'] %}
              <li>
                <span>{{ ann['content'] }}</span>
                <a data-tooltip="jump to annotation" target="_parent" href="/#document/{{ report_uuid }}/{{ study['pdf_uuid'] }}?annotation_type=bias_bot&uuid={{ ann['uuid'] }}" class="annotation-link"><i class="fa fa-file-pdf-o" aria-hidden="true"></i></a>
              </li>
            {% endfor %}
            </ol>
          </td>
        </tr>
        {% endfor %}
      </table>
      {% endfor %}

      <h2>References</h2>

      {% for study in articles %}
      <p>{{ loop.index }}. {{ study['citation'] }}</p>
      {% endfor %}

    </div>
  </body>
</html>
